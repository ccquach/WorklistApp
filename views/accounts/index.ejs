<% include ../partials/header %>

<div class="ui main container">
	<!-- HEADER -->
	<h2 class="ui center aligned icon header">
		<i class="circular browser icon"></i>
	</h2>
	
	<!-- SECONDARY MENU -->
	<div class="ui secondary menu">
		<div class="right menu">
			<!-- ADD ACCOUNT -->
			<div class="item">
				<a class="add user icon button" data-tooltip="Add Account" data-position="top center" href="/accounts/new">
					<i class="add user icon"></i>
				</a>
			</div>

			<!-- SEARCH BAR -->
			<div class="right menu">
				<div class="ui item">
					<div class="ui icon input">
						<input class="prompt" type="text" name="" placeholder="Search Account...">
						<i class="search link icon"></i>
					</div>
					<div class="results"></div>
				</div>
			</div>
		</div>
	</div>

	<!-- TABLE -->
	<table class="ui fixed single line selectable sortable celled green table">
		<thead>
			<tr>
				<th class="two wide">Account #</th>
				<th class="six wide">Patient Name</th>
				<th class="four wide">Current Balance</th>
				<th class="two wide">Date Added</th>
				<th class="two wide">Last Modified</th>
			</tr>
		</thead>
		<tbody>
			<% accounts.forEach(function(account) { %>
				<tr class="clickable-row" data-href="/accounts/<%= account._id %>">
					<td><%= account.number %></td>
					<td><%= account.lastName %>, <%= account.firstName %></td>
					<td>$<%= account.currentBalance.toFixed(2) %></td>
					<td><%= moment(account.createdAt).format("M/D/YYYY") %></td>
					<td><%= moment(account.lastModified).format("M/D/YYYY") %></td>
				</tr>
			<% }) %>
		</tbody>
		<tfoot>
			<!-- Pagination -->
			<% if (pages && pages > 0) { %>
				<tr>
					<th colspan="5">
						<div class="ui centered grid">
							<div class="center aligned column">
								<div class="ui pagination menu">
									<!-- First -->
									<% if (current == 1) { %>
										<a class="icon item">
											<i class="large angle double left icon"></i>
										</a>
									<% } else { %>
										<a class="icon item" href="/accounts">
											<i class="large angle double left icon"></i>
										</a>
									<% } %>

									<!-- Left Chevron -->
									<% if (current == 1) { %>
										<a class="icon item">
											<i class="left chevron icon"></i>
										</a>
									<% } else { %>
										<a class="icon item" href="/accounts?page=<%= Number(current) - 1 %>">
											<i class="left chevron icon"></i>
										</a>
									<% } %>

									<!-- Left Continued -->
									<% var i = (Number(current) > 5 ? Number(current) - 4 : 1) %>
									<% if (i !== 1) { %>
										<a class="item">...</a>
									<% } %>

									<% for (; i <= (Number(current) + 4) && i <= pages; i++) { %>
										<!-- Pages -->
										<% if (i == current) { %>
											<a class="active item"><%= i %></a>
										<% } else { %>
											<a class="item" href="/accounts?page=<%= i %>"><%= i %></a>
										<% } %>

										<!-- Right Continued -->
										<% if (i === Number(current) + 4 && i < pages) { %>
											<a class="item">...</a>
										<% } %>
									<% } %>

									<!-- Right Chevron -->
									<% if (current == pages) { %>
										<a class="icon item">
											<i class="right chevron icon"></i>
										</a>
									<% } else { %>
										<a class="icon item" href="/accounts?page=<%= Number(current) + 1 %>">
											<i class="right chevron icon"></i>
										</a>
									<% } %>

									<!-- Last -->
									<% if (current == pages) { %>
										<a class="icon item">
											<i class="large angle double right icon"></i>
										</a>
									<% } else { %>
										<a class="icon item" href="/accounts?page=<%= pages %>">
											<i class="large angle double right icon"></i>
										</a>
									<% } %>
								</div>
							</div>
						</div>
					</th>
				</tr>
			<% } %>
		</tfoot>
	</table>
</div>

<script type="text/javascript">
	$(document).ready(function() {
		$(".clickable-row").on("click", function() {
			window.location.href = $(this).data("href");
		});
	})
</script>

<% include ../partials/footer %>